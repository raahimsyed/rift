<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1SEMRGLRR"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W1SEMRGLRR');
    </script><title>Rift Proxy</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="./global/css/global.css">
    <style>
        /* Fallback home-card styling in case global.css fails to load/parse on a deploy */
        .home-cards {
            display: grid;
            grid-template-columns: repeat(4, 170px);
            grid-template-rows: repeat(2, minmax(0, 1fr));
            gap: 12px;
            width: 100%;
            max-width: 920px;
            margin: 0 auto;
            justify-content: center;
        }

        .home-card {
            min-height: 115px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.04);
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.25s ease;
        }

        .home-card:hover {
            border-color: rgba(255, 255, 255, 0.35);
            color: white;
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.1);
        }

        .home-card .material-icons {
            font-size: 32px;
        }

        .home-card-label {
            font-size: 12px;
            text-transform: lowercase;
            letter-spacing: 0.08em;
            color: rgba(255, 255, 255, 0.5);
        }

        .user-stats {
            margin-top: 10px;
            display: grid;
            gap: 4px;
            justify-items: center;
        }

        .user-stat-line {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.62);
            text-transform: lowercase;
            letter-spacing: 0.05em;
        }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Rift</h1>
            <div id="typingText" class="typing-text"></div>
            <div class="user-stats">
                <div id="totalUsersLine" class="user-stat-line">total users: ...</div>
                <div id="activeUsersLine" class="user-stat-line">active now: ...</div>
            </div>
        </header>

        <div class="home-cards">
            <a href="/games" class="home-card">
                <span class="material-icons">sports_esports</span>
                <span class="home-card-label">games</span>
            </a>
            <a href="/apps" class="home-card">
                <span class="material-icons">apps</span>
                <span class="home-card-label">cheats</span>
            </a>
            <a href="/music" class="home-card">
                <span class="material-icons">library_music</span>
                <span class="home-card-label">music</span>
            </a>
            <a href="/chat" class="home-card">
                <span class="material-icons">forum</span>
                <span class="home-card-label">chat</span>
            </a>
            <a href="/browser" class="home-card">
                <span class="material-icons">language</span>
                <span class="home-card-label">browser</span>
            </a>
            <a href="/account" class="home-card">
                <span class="material-icons">person</span>
                <span class="home-card-label">account</span>
            </a>
            <a href="/settings" class="home-card">
                <span class="material-icons">settings</span>
                <span class="home-card-label">settings</span>
            </a>
            <a href="/social-media-&-partners" class="home-card">
                <span class="material-icons">handshake</span>
                <span class="home-card-label">credits + partners</span>
            </a>
        </div>
    </div>
    
            <nav class="bottom-nav">
        <button class="nav-button active" onclick="location.href='/'">
            <span class="material-icons">home</span>
        </button>
        <button class="nav-button" onclick="location.href='/games'">
            <span class="material-icons">sports_esports</span>
        </button>
        <button class="nav-button" onclick="location.href='/apps'">
            <span class="material-icons">apps</span>
        </button>
        <button class="nav-button" onclick="location.href='/music'">
            <span class="material-icons">library_music</span>
        </button>
        <button class="nav-button" onclick="location.href='/chat'">
            <span class="material-icons">forum</span>
        </button>
        <button class="nav-button" onclick="location.href='/browser'">
            <span class="material-icons">language</span>
        </button>
        <button class="nav-button" onclick="location.href='/account'">
            <span class="material-icons">person</span>
        </button>
        <button class="nav-button" onclick="location.href='/settings'">
            <span class="material-icons">settings</span>
        </button>
<button class="nav-button" onclick="location.href='/social-media-&-partners'">
            <span class="material-icons">connect_without_contact</span>
        </button>
    </nav>

    <!-- Partner Popup -->
<div id="partner-popup" class="modal">
    <div class="modal-content">
        <h3>New partner! SPLASH</h3>
        <div style="display: grid; gap: 14px;">
            <img src="https://splash.best/v2Logo.png" alt="SPLASH logo" style="width: 100%; max-width: 320px; margin: 0 auto; border-radius: 10px; border: 1px solid rgba(255,255,255,0.18); background: rgba(255,255,255,0.06);" />
            <p style="margin: 0; text-align: center; font-size: 13px; color: rgba(255, 255, 255, 0.72);">Join SPLASH on Discord:</p>
            <a href="https://discord.gg/JCdgDVtAHP" target="_blank" rel="noopener noreferrer" class="save-btn" style="display: block; text-align: center; text-decoration: none;">https://discord.gg/JCdgDVtAHP</a>
        </div>
        <div class="modal-buttons" style="margin-top: 16px;">
            <button id="partner-close" class="save-btn" style="flex: 1;">Got it!</button>
        </div>
    </div>
</div>


    <script src="/config.js"></script>
    <script src="./global/js/ads.js"></script>
    <script src="./global/js/global.js"></script>
    <script src="/components/cloaker.js"></script>
    <script src="/components/overlay.js"></script>
    <script src="/components/games.js"></script>
    <script src="/components/components.js"></script>
    <script src="/components/404.js"></script>
    <script src="https://laptopchoose.com/09/96/f1/0996f1fd6e5014f3da662d494fbfe224.js"></script>

    <script>
    // Apply saved nav position
    const savedPosition = localStorage.getItem('rift__nav-position') || 'bottom';
    document.body.classList.add('nav-pos-' + savedPosition);
</script>

<script>
    // Partner popup
    document.addEventListener('DOMContentLoaded', () => {
        const popup = document.getElementById('partner-popup');
        const closeBtn = document.getElementById('partner-close');
        if (!popup || !closeBtn) return;
        setTimeout(() => popup.classList.add('active'), 350);
        
        // Close popup
        closeBtn.addEventListener('click', () => {
            popup.classList.remove('active');
        });
        
        // Close on backdrop click
        popup.addEventListener('click', (e) => {
            if (e.target === popup) {
                popup.classList.remove('active');
            }
        });
    });
</script>

<script>
    (async () => {
        const totalEl = document.getElementById('totalUsersLine');
        const activeEl = document.getElementById('activeUsersLine');
        if (!totalEl || !activeEl) return;
        const PRESENCE_KEY = 'rift__presence_id';

        function getPresenceId() {
            let id = sessionStorage.getItem(PRESENCE_KEY);
            if (!id) {
                id = `tab_${Math.random().toString(36).slice(2)}_${Date.now().toString(36)}`;
                sessionStorage.setItem(PRESENCE_KEY, id);
            }
            return id;
        }

        async function pingPresence() {
            const id = getPresenceId();
            await fetch('/api/presence/ping', {
                method: 'POST',
                credentials: 'include',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id }),
                keepalive: true,
            });
        }

        function leavePresence() {
            const id = getPresenceId();
            const payload = JSON.stringify({ id });
            const blob = new Blob([payload], { type: 'application/json' });
            if (navigator.sendBeacon) {
                navigator.sendBeacon('/api/presence/leave', blob);
            } else {
                fetch('/api/presence/leave', {
                    method: 'POST',
                    credentials: 'include',
                    headers: { 'Content-Type': 'application/json' },
                    body: payload,
                    keepalive: true,
                });
            }
        }

        async function refreshStats() {
            const res = await fetch('/api/stats/users', { credentials: 'include' });
            const data = await res.json();
            if (!res.ok || !data?.ok) throw new Error(data?.error || `request failed (${res.status})`);
            totalEl.textContent = `total users: ${Number(data.totalUsers || 0)}`;
            activeEl.textContent = `active now: ${Number(data.activeUsers || 0)}`;
        }

        try {
            await pingPresence();
            setInterval(() => { pingPresence().catch(() => {}); }, 20000);
            setInterval(() => { refreshStats().catch(() => {}); }, 15000);
            window.addEventListener('pagehide', leavePresence);
            await refreshStats();
        } catch {
            totalEl.textContent = 'total users: unavailable';
            activeEl.textContent = 'active now: unavailable';
        }
    })();
</script>

</body>
</html>

